<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="blockly_compressed.js"></script>
        <script src="blocks_compressed.js"></script>
        <script src="javascript_compressed.js"></script>
        <script src="uk.js"></script>
        <script src="car_configuration.js"></script>
        <script src="block_options.js"></script>
    </head>
    <body>
        <div id="blocklyDiv" style="height: 800px; width: 1200;"></div>
        <button value="Generate code" name="Generate code" onclick="generateCode()">Generate code</button>
        <script>

        </script>
        <xml id="toolbox" style="display: none">
            <block type="controls_if"></block>
            <block type="controls_repeat_ext"></block>
            <block type="logic_compare"></block>
            <block type="math_number"></block>
            <block type="math_arithmetic"></block>
            <block type="text"></block>
            <block type="run_both_motors_for_power_and_time_function"></block>
            <block type="run_motor_for_power_and_time_function"></block>
            <block type="run_motor_for_distance_and_power_function"></block>
            <block type="turn_n_grad_function"></block>
            <block type="stop_selected_motor_function"></block>
            <block type="stop_all_motors_function"></block>
            <block type="check_if_barrier_is_close_than_n_sm_then_turn_k_grad_function"></block>

        </xml>
        <script>
            var workspace = Blockly.inject('blocklyDiv',
                {toolbox: document.getElementById('toolbox')});
        function generateCode(){
            var code = Blockly.JavaScript.workspaceToCode(workspace);
            var BASE_SKETCH_CONTENT = CAR_PIN_CONTANTS +
                RUN_MOTOR_FOR_POWER_AND_TIME_FUNCTION +
                RUN_BOTH_MOTORS_FOR_POWER_AND_TIME_FUNCTION +
                "void setup(){" + CAR_PINS_SETUP +"}void loop(){if(runOnce){" + code + "}runOnce = false; "+ FLUSH_ALL_PINS +"}";
            console.log(BASE_SKETCH_CONTENT);
  
        }
        </script>

    </body>
</html>
